---
title: "COVID-19 Data"
author: "Brian Gulbis, PharmD, BCPS"
date: '`r format(Sys.Date(), "%B %d, %Y")`'
output: 
    html_document:
        code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

```{r}
library(tidyverse)
library(lubridate)
```

```{r}
data_dir <- "csse_covid_19_data/csse_covid_19_daily_reports"

# f <- list.files(data_dir, pattern = "csv", full.names = TRUE)

# x <- map(f, read_csv)
# raw_daily <- map_df(f, read_csv)
# day1 <- read_csv("csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv")
# yest <- read_csv("csse_covid_19_data/csse_covid_19_daily_reports/03-22-2020.csv")
curr <- read_csv("csse_covid_19_data/csse_covid_19_daily_reports/03-23-2020.csv")
```

```{r}
df_confirm <- read_csv("csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv") %>%
    rename(
        state = `Province/State`,
        country = `Country/Region`,
        lat = Lat,
        long = Long
    ) %>%
    pivot_longer(
        cols = c(-state, -country, -lat, -long), 
        names_to = "date", 
        values_to = "confirmed"
    ) %>%
    mutate_at("date", as_date, format = "%m/%d/%y", tz = "UTC")

df_deaths <- read_csv("csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv") %>%
    rename(
        state = `Province/State`,
        country = `Country/Region`,
        lat = Lat,
        long = Long
    ) %>%
    pivot_longer(
        cols = c(-state, -country, -lat, -long), 
        names_to = "date", 
        values_to = "deaths"
    ) %>%
    mutate_at("date", as_date, format = "%m/%d/%y", tz = "UTC")

df_ts <- left_join(df_confirm, df_deaths)
```

```{r, eval=FALSE}
df_recover <- read_csv("csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Recovered.csv") %>%
    rename(
        state = `Province/State`,
        country = `Country/Region`,
        lat = Lat,
        long = Long
    ) %>%
    pivot_longer(
        cols = c(-state, -country, -lat, -long), 
        names_to = "date", 
        values_to = "recovered"
    ) %>%
    mutate_at("date", as_date, format = "%m/%d/%y", tz = "UTC")

df_confirm_old <- read_csv("csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Confirmed.csv") %>%
    rename(
        state = `Province/State`,
        country = `Country/Region`,
        lat = Lat,
        long = Long
    ) %>%
    pivot_longer(
        cols = c(-state, -country, -lat, -long), 
        names_to = "date", 
        values_to = "confirmed"
    ) %>%
    mutate_at("date", as_date, format = "%m/%d/%y", tz = "UTC")

df_deaths_old <- read_csv("csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Deaths.csv") %>%
    rename(
        state = `Province/State`,
        country = `Country/Region`,
        lat = Lat,
        long = Long
    ) %>%
    pivot_longer(
        cols = c(-state, -country, -lat, -long), 
        names_to = "date", 
        values_to = "deaths"
    ) %>%
    mutate_at("date", as_date, format = "%m/%d/%y", tz = "UTC")

df_ts_old <- df_confirm_old %>%
    left_join(df_deaths_old) %>%
    left_join(df_recover)

```

```{r}

```


